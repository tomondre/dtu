
First version: 
```
PProtocol: SecureTicketPlatform  
Types: Agent A, B, s;  
       Function pk, sk;  
       Number NA, NB;  
       Symmetric_key TempSecret;  
Knowledge:  
  A: A, B, s, sk(A,B), pk(s); # Client app  
  B: A, B, s, sk(A,B), sk(B,s), pk(B), inv(pk(B)); # Ticket platform  
  s: A, B, s, sk(B,s), pk(s), inv(pk(s)); # Payment provider  
  where A!=B  
Actions:  
  A -> B: {| OrderRequest, { PaymentInfo, TempSecret }pk(s), NA |}sk(A,B)  
  B -> s: {| { PaymentInfo, TempSecret }pk(s), NB, NA, A, B |}sk(B,s)  
  s -> B: {| OrderConfirmation, A, B, NB |}sk(B,s), {| OrderConfirmation, A, B, NA |}TempSecret  
  B -> A: {| {| OrderConfirmation, A, B, NA |}TempSecret, Ticket |}sk(A,B)  
Goals:  
  OrderConfirmation secret between A, B, s;  
  A authenticates s on OrderConfirmation,B  
  B authenticates s on OrderConfirmation,A
```
*  A *->*B communication is secure, as the previous authentication protocol has established this confidential and authentic connection
* OrderConfirmation/receipt used as a source of truth
	* The Order Confirmation is generated by trusted parties (Payment Provider), that ensures the Confirmation is trustworthy

Second version: 
Changed the way an order confirmation is send to A. Previously the order confirmation was send to A via B, however B may be dishonest and not forward the confirmation. The confirmation is encrypted via the established TempSecret

```
Protocol: SecureTicketPlatform  
Types: Agent A, B, s;  
       Function pk, sk;  
       Number NA, NB;  
       Symmetric_key TempSecret;  
Knowledge:  
  A: A, B, s, pk(s), sk(A,B); # Client app  
  B: A, B, s, sk(A,B), sk(B, s); # Ticket platform  
  s: A, B, s, pk(s), inv(pk(s)), sk(B, s); # Payment provider  
  where A!=B  
Actions:  
  # Order Request and Payment  
  A -> B: {| OrderRequest, { PaymentInfo, TempSecret }pk(s), NA |}sk(A,B)  
  B -> s: {| { PaymentInfo, TempSecret }pk(s), NB, NA, A, B |}sk(B, s)  
  s -> B: {| OrderConfirmation, A, B, NB |}sk(B, s)  
  B -> A: {| A, B, NA, NB, Ticket |}sk(A,B)  
  
  # Payment Validation  
  A -> s: {| A, NA |}TempSecret  
  s -> A: {| OrderConfirmation, A, NA |}TempSecret  
Goals:  
  OrderConfirmation secret between A, B, s;  
  A authenticates s on OrderConfirmation,B  
  B authenticates s on OrderConfirmation,A  
  A authenticates s on TempSecret
```

This way we ensure that A can obtain OrderConfirmation even if B does not forward it

## Third version
